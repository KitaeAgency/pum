{% extends "PumWoodworkBundle::layout.html.twig" %}

{% set menu_active ='beams' %}

{% block content %}
    <div class="pum-row-head">
        <div class="pum-action-bar pull-right">
            <a class="btn btn-primary btn-sm" href="{{ path('ww_beam_import') }}"><i class="pumicon pumicon-download3"></i> Import a Beam</a>
            <a href="{{ path('ww_beam_create') }}" class="btn pum-scheme-btn-darkgrass"><i class="pumicon pumicon-plus6"></i> Create a Beam</a>
            <!-- Change View
            <div class="btn-group" data-toggle="buttons">
                <label class="btn active">
                    <input type="radio" name="options" id="option1" checked="checked" /> <i class="pumicon pumicon-reorder"></i>
                </label>
                <label class="btn">
                    <input type="radio" name="options" id="option2" /> <i class="pumicon pumicon-th-large"></i>
                </label>
            </div>
            -->
        </div>
        {{ pum_macros.section_title('Beams', null, null, [
            {
                href: path('ww_homepage'),
                text: 'Woodwork'
            },
            {
                href: path('ww_beam_list'),
                text: 'Beams'
            },
            {
                text: 'Manage all your beams'
            }
        ]) }}
    </div>

    {{ pum_macros.alertMessages() }}

    <div class="row">
        <div class="col-lg-12 col-offset-auto">
            <table class="table table-bordered table-striped table-hover">
                <col width="3%" />
                <col width="3%" />
                <thead>
                    <tr>
                        <th class="text-center"><input type="checkbox" name="all_beams" /></th>
                        <th class="text-right">#</th>
                        <th class="pum-scheme-cell-belizehole pum-schemed_cell">
                            <div class="pum-schemed_cell_wrapper">
                                Name
                            </div>
                        </th>
                        <th class="pum-scheme-cell-belizehole pum-schemed_cell">
                            <div class="pum-schemed_cell_wrapper">
                                <i class="pumicon pumicon-archive2 hidden-xs"></i>
                                Objects
                            </div>
                        </th>
                        <th class="pum-scheme-cell-pomegranate pum-schemed_cell">
                            <div class="pum-schemed_cell_wrapper">
                                <i class="pumicon pumicon-briefcase3 hidden-xs"></i>
                                Project
                            </div>
                        </th>
                        <th class="pum-schemed_cell">
                            <div class="pum-schemed_cell_wrapper">
                                <i class="pumicon pumicon-settings2 hidden-xs"></i>
                                Actions
                            </div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    {% for beam in beams %}
                        <tr id="beam_{{ beam.id }}">
                            <td class="text-center is_checkable"><input type="checkbox" name="project[{{ beam.id }}]" value="1" /></td>
                            <td class="text-right">{{ beam.id }}</td>
                            <td class="pum-scheme-colored-{{ beam.color }}">
                                <i class="pumicon pumicon-{{ beam.icon }}"></i>
                                <strong>{{ beam.name }}</strong>
                            </td>
                            <td class="pum-scheme-colored-belizehole">
                                {{ pum_macros.collapsed_list('beam_def_' ~ beam.id, beam.objects, ['object', 'objects'], 5, 'code') }}
                            </td>
                            <td class="pum-scheme-colored-pomegranate">
                                {{ pum_macros.collapsed_list('beam_proj_' ~ beam.id, beam.projects, ['project', 'projects'], 5) }}
                            </td>
                            <td>
                                <a class="btn btn-sm pum-scheme-btn-darkgrass" title="Edit beam {{ beam.name }}" href="{{ path('ww_beam_edit', {beamName: beam.name}) }}">Edit</a>
                                <a class="btn btn-sm btn-warning" title="Clone beam {{ beam.name }}" href="{{ path('ww_beam_clone', {beamName: beam.name}) }}">Clone</a>
                                {% if beam.deletable %}
                                    <a class="btn btn-sm btn-danger" title="Delete beam {{ beam.name }}" data-cancel="Cancel" data-confirm="Delete" data-text='Are you sure to delete this beam "{{ beam.name }}" ?' href="{{ path('ww_beam_delete', {beamName: beam.name}) }}">Delete</a>
                                {% else %}
                                    <a class="btn btn-sm btn-danger disabled" data-toggle="tooltip" title="Beam {{ beam.name }} is used in {% for project in beam.projects %}{{ project.name }}{% if not loop.last %}, {% endif %}{% endfor %}" href="#">Delete</a>
                                {% endif %}
                                <a class="btn btn-sm btn-primary" title="Export beam {{ beam.name }}" href="{{ path('ww_beam_export', {beamName: beam.name}) }}">Export</a>
                            </td>
                        </tr>
                    {% else %}
                        <tr class="info">
                            <td colspan="4"><em>No beam found. </em><a href="{{ path('ww_beam_create') }}">Create a new beam</a></td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}
